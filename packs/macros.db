{"name":"Instant Defaults","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/sundries/flags/banner-yellow.webp","scope":"global","command":"InstantDefaults.skillChooser()","flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.JDV9ZoJ2Q6vQUSql"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547621,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"02odDoOhUa4nemQ7"}
{"name":"Throwing Calculator","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/skills/ranged/bomb-grenade-thrown-purple.webp","scope":"global","command":"// // if (canvas.tokens.controlled.length === 0)\n// //   return ui.notifications.error(\"Select the falling token\");\n\n if (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select a token\");\n\n\n\nconst myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/throwing.html\");\n\nnew Dialog({\n  title: \"GURPS\",\n  content: myContent,\n  buttons: {}\n}, { id: 'GURPScss'}).render(true);","flags":{"core":{"sourceId":"Macro.IbF4f8qjepR6bZ9t"},"cf":{"id":"temp_etvk8gr4cam"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547621,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"0TAheGWP5AROQwLb"}
{"name":"mostra imagem de token","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"const options = canvas.tokens.placeables.filter(t => !t.data.hidden).reduce((acc, t) => \n    acc += `<label><img src=\"${t.actor.data.img}\" title=\"${t.data.name}\"></label>`, \n``);\n\nconst content = `\n    <style>\n        #tokenList {\n            margin:10px;\n        }\n        #tokenList.form-group img {\n            border:0px;\n            height:60px;\n            min-width:60px;\n        }\n        #tokenList.form-group img:hover {\n            transform: scale(2);\n        }\n    </style>\n    <form>\n        <div class=\"form-group\" id=\"tokenList\">\n            ${options}\n        </div>\n    </form>`;\n\n\nconst d = new Dialog({\n    title: \"Show Token Art\",\n    content,\n    buttons: {\n        ok: {\n            label: \"ok\"\n        }\n    },\n    default: \"yes\",\n    render: (html) => {\n        html.find(\"#tokenList img\").click(function() {\n            const popout = new ImagePopout(this.src);\n            popout.render(true);\n        });\n    }    \n},\n{\n    width: 650\n}).render(true);","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1670044466435,"modifiedTime":1670259507351,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"4SKuNAbusiwekKpM"}
{"name":"Hiking Calculator","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/skills/movement/feet-winged-sandals-tan.webp","scope":"global","command":"// if (canvas.tokens.controlled.length === 0)\n//   return ui.notifications.error(\"Select the falling token\");\n\nif (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select the token leader\");\n\n\n\nconst myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/hiking.html\");\n\nnew Dialog({\n  title: \"GURPS Hiking Calculator\",\n  content: myContent,\n  buttons: {}\n}).render(true);","flags":{"core":{"sourceId":"Macro.TbasT3DKsY3L0nec"},"cf":{"id":"temp_etvk8gr4cam"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547622,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"6QQwbjw5DI8Nhy7u"}
{"name":"Macros Folder","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/containers/boxes/crate-heavy-yellow.webp","scope":"global","command":"const managerType = \"Macros Folder\";\n\n(() => {\n  const macros = [\n    \"Random Treasure Generator\",\n    \"Instant Defaults\",\n    \"Tables Folder\",\n    \"Hiking Calculator\",\n    \"Falling Calculator\",\n    \"Throwing Calculator\",\n    \"Sight Togle\",\n    \"Fatigue\",\n    \"Sight Toggle\",\n    \"Sight Adjustment\",\n    \"Body Parts\",\n    \"Healing Tool\"\n\n  ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  macros.forEach((str) => {\n    let macro = game.macros.getName(str);\n    if (!macro) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#GURPScs .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #GURPScs header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#GURPScs .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #GURPScs .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${macro.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.macros.getName(str).execute();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"GURPScs\" }\n  ).render(true);\n})();","flags":{"core":{"sourceId":"Macro.ul71YhG3o9fguYNU"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547625,"modifiedTime":1669696547625,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"6pvKH4kMzvWgbmcB"}
{"name":"ReactionRoll","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/environment/people/group.webp","scope":"global","command":"let r = new Roll(\"3d6 + @mod\", { mod: GURPS.ModifierBucket.currentSum()})\ngame.tables.getName(\"Reaction Rolls\").draw({roll:r})\nGURPS.ModifierBucket.clear()","flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.BAVCAmeEE34jS0dN"},"importid":"SwxFagE3eJmQSiTu","cf":{"id":"temp_58ibxbr8cng"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547622,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"8oH7TPH1GJFhi8jN"}
{"name":"Tables Folder","type":"script","author":"mW8b5k19Zu6i2R2v","img":"modules/gurps-instant-defaults/img/icons/critical.png","scope":"global","command":"const managerType = \"Tables Folder\";\n\n(() => {\n  const tables = [\n    \"Critical Head Blow\",\n    \"Critical Hit\",\n    \"Critical Magic\",\n    \"Critical Miss\",\n    \"Critical Unarmed Strike\",\n    \"Reaction Rolls\",\n    \"Sight Toggle\",\n    \"Sight Adjustment\",\n    \"Healing Tool\",\n    \"Body Parts\"\n\n  ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  tables.forEach((str) => {\n    let table = game.tables.getName(str);\n    if (!table) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#tf .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #bp header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#tf .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #tf .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${table.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.tables.getName(str).draw();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"tf\" }\n  ).render(true);\n})();","flags":{"core":{"sourceId":"Macro.PiqMWUzecRiYnlTN"},"cf":{"id":"temp_58ibxbr8cng"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547625,"modifiedTime":1669696547625,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"AgKR8PJVGy3nBNMH"}
{"name":"Random Treasure Generator","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/commodities/currency/coins-crown-stack-gold.webp","scope":"global","command":"const myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/generator.html\");\n\nnew Dialog({\n  title: \"GURPS\",\n  content: myContent,\n  buttons: {}\n}).render(true);","flags":{"core":{"sourceId":"Macro.wSj4vPsv6Xmxhldm"},"cf":{"id":"temp_etvk8gr4cam"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547625,"modifiedTime":1669696547625,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"EGvJiSUpUUQD7Asg"}
{"name":"Hover","type":"chat","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/magic/air/wind-weather-snow-gusts.webp","command":"//Require TokenMagicFx Module and Jb2a.\n//Don't cry.\n\n\nconst effects = Sequencer.EffectManager.getEffects({ name: \"*Levita*\" });\nconst tokenD = canvas.tokens.controlled[0];\n\n\nif(effects.length){\n  Sequencer.EffectManager.endEffects({ name: \"*Levita*\" });\n  token.document.update({elevation: token.data.elevation =0});\n  \n   TokenMagic.deleteFiltersOnSelected();\n//TokenMagic.addUpdateFiltersOnSelected();\n  }else{\n\ntoken.document.update({elevation: token.data.elevation +10});\n\n\n\n\nnew Sequence()\n    .effect()\n        .file(\"modules/jb2a_patreon/Library/TMFX/OutFlow/Circle/OutFlow_02_Circle_500x500.webm\") \n        .scale(2)\n        .atLocation(tokenD)\n        .attachTo(tokenD, { bindVisibility: false} )\n        .belowTokens()\n        .opacity(0.5)\n        .persist()\n        .name(\"Levita\")\n\n        .effect()\n        .file(\"worlds/comupunk/animations/aviso.webp\") \n        .scale(1.2)\n        .atLocation(tokenD)\n        .attachTo(tokenD, { bindVisibility: false} )\n        .belowTokens()\n        // .spriteOffset({ x: 10, y: 300 })\n        .opacity(0.4)\n        .persist()\n\n\n        .name(\"Levita\")\n\n            \n    .play()\n    \n    let params =\n    [{\n        filterType: \"shadow\",\n        filterId: \"myShadow\",\n        rotation: 195,\n        blur: 3,\n        quality: 5,\n        distance: 20,\n        alpha: 0.6,\n        padding: 20,\n        shadowOnly: false,\n        color: 0x000000,\n        zOrder: 8000,\n        animated:\n        {\n            blur:     \n            { \n               active: true, \n               loopDuration: 500, \n               animType: \"syncCosOscillation\", \n               val1: 2, \n               val2: 4\n            },\n            rotation:\n            {\n               active: true,\n               loopDuration: 100,\n               animType: \"syncSinOscillation\",\n               val1: 33,\n               val2: 37\n            }\n         }\n    }];\n    \n    let params2 =\n        [{\n            filterType: \"transform\",\n            filterId: \"dodgeStance\",\n            padding: 50,\n            animated:\n            {\n                translationX:\n                {\n                    animType: \"sinOscillation\",\n                    val1: -0.060,\n                    val2: +0.060,\n                    loopDuration: 9600,\n                },\n                translationY:\n                {\n                    animType: \"cosOscillation\",\n                    val1: -0.035,\n                    val2: +0.035,\n                    loopDuration: 9400,\n                }\n            }\n        }];\nawait TokenMagic.addUpdateFiltersOnSelected(params);\nawait TokenMagic.addUpdateFiltersOnSelected(params2);\n \n  }","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1670263972783,"modifiedTime":1670264091198,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"FjALz9PbTwVGdu2O"}
{"name":"Grenades Distance","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/weapons/thrown/bomb-fuse-red-black.webp","scope":"global","command":"tokenD = canvas.tokens.controlled[0]\nif(!token) return;\nconst targets = Array.from(game.user.targets);\nconst gridSize = canvas.grid.size;\nconst startPoint = {x:tokenD.x,y: tokenD.y};\nlet messageData = \"<h2>Grenade Distance</h2><br>\";\n\nfunction d6(min, max) { \n    return Math.floor(Math.random() * (max - min + 1) + min)\n  }\n\n targets.forEach(async target => {\n    const distance = canvas.grid.measureDistance(startPoint, target, {gridSpaces: true}).toFixed(1); \n    let c = 0 \n    while (c <= 20 ){\n    if (distance == c)messageData += `<b>${target.name}</b> Is <b>${c} yards </b>from grenade <br>`;\n        c++\n}\n    \n});\nChatMessage.create({content: messageData});","flags":{"core":{"sourceId":"Macro.IP19df5Giwp6zFmf"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547621,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"FqLB3LKzDMz9HeTt"}
{"name":"Apply Manual Damage","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/skills/wounds/injury-pain-body-orange.webp","scope":"global","command":"function manualDamage(damage, type) {\n  GURPS.executeOTF(`/r [${damage} ${type}]`);\n}\nnew Dialog({\n  title: `Manual Damage`,\n  content: \n`<form>\n<style>\nform#form-group {\n  background-color: red;\n}\n</style>\n <form>\n      <div class=\"form-group\">\n        <label>Damage Type: </label>\n        <select id=\"damageType\" name=\"damageType\">\n          <option value=\"burn\">Burning</option>\n          <option value=\"cor\">Corrosion</option>\n          <option value=\"cr\">Crushing</option>\n          <option value=\"imp\">Impaling</option>\n          <option value=\"pi-\">Smal piercing</option>\n          <option value=\"pi\">Piercing</option>\n          <option value=\"pi+\">Large Piercing</option>\n          <option value=\"pi+\">Large Piercing</option>\n          <option value=\"pi++\">Huge Piercing</option>\n          <option value=\"tox\">Toxic</option>\n          <option value=\"sh\">Shield</option>\n             \n          \n          \n          </select>\n      </div>\n     \n  </form>  \n  \n  <form>\n<div class=\"form-group\">\n  <label>Damage Amount:</label>\n  <input id=\"damageAmount\" name=\"damageAmount\"  value=\"\" min=\"1\" max=\"20\">\n  </div>   \n  `,\n  buttons: {\n    confirm: {\n      label: \"Confirm\",\n      callback: async (html) => {\n        manualDamage(html.find('#damageAmount').val(), html.find('#damageType').val());\n      }\n    }\n  }\n}, {\n  width: 400\n}).render(true);","flags":{"core":{"sourceId":"Macro.Bjf1SqGzABywtOTp"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547623,"modifiedTime":1669696547623,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"Mipo4PgkYWdvN0gW"}
{"name":"Colored Borders","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/magic/symbols/ring-circle-smoke-blue.webp","command":"const myContent = `<style>\n    .callheader {\n      background-color: black;\n      font-family: Roboto, sans-serif;\n      color: white;\n      text-align: center;\n      vertical-align: middle;\n      line-height: 50px;\n      height: 50px;\n      margin-bottom: 10px;\n      border-radius: 0.375rem;\n      font-size: 18px;\n      text-decoration: none;\n    }\n  </style>\n  <div class=\"callheader\">Colored Borders</div>\n\n  <form>\n    <div class=\"form-group\">\n      <label>Size</label>\n      <div class=\"form-fields\">\n        <input id=\"sizes\" type=\"number\" name=\"sizes\">\n      </div>\n    </div>\n  </form>\n  <div class=\"coluna3\">\n    <form>\n      <div class=\"form-group\">\n        <label style=\"text-align: left\">Color </label>\n        <div class=\"form-fields\">\n          <select id=\"cores\" name=\"cores\">\n            <option value=\"yellow\">Yellow</option>\n            <option value=\"Pink\">Purple</option>\n            <option value=\"blue\">Blue</option>\n            <option value=\"bluewhite\">Blue White</option>\n            <option value=\"Pink\">Pink</option>\n            <option value=\"Red\">Red</option>\n            <option value=\"Orange\">Orange</option>\n            <option value=\"Red\">Red</option>\n            <option value=\"White\">White</option>\n            <option value=\"Green\">Green</option>     \n            <option value=\"sides\">Sides</option>       \n              <option value=\"cyberpunk\">Cyberpunk</option>       \n\n          </select>\n        </div>\n      </div>\n    </form>\n  </div>\n  <br>\n  <button class=\"banana-set-size\" role=\"button\">Banana</button>\n`;\n\n\nlet error = false;\n\nif (!(game.modules.get(\"sequencer\")?.active)) {\n    error = `You need to have Sequencer installed and activated to run this macro!`;\n}\nif (error) {\n    ui.notifications.error(error);\n    return;\n}\n\nconst macro = this;\nnew Dialog({\n    title: \"GURPS Instant Colored Borders\",\n    content: myContent,\n    buttons: {},\n    render: async (html) => listeners(html)\n}).render(true);\n\nasync function listeners(html) {\n    if (macro.getFlag(\"world\", \"sizes\")) html.find(\"#sizes\").val(macro.getFlag(\"world\", \"sizes\"));\n    else html.find(\"#sizes\").val(0);\n    html.click(async function (event) {\n        if (event.target.className === \"banana-set-size\") {\n            const size = html.find(\"#sizes\").val(); \n            const cor = html.find(\"#cores\").val(); \n            await macro.setFlag(\"world\", \"sizes\", size);\n            await aplica(size, cor);\n            html.find(\"#sizes\").val(size)\n        }\n    });\n}\nasync function aplica(size, cor) {\n    let token = canvas.tokens.controlled[0]\n    const effects = Sequencer.EffectManager.getEffects({\n        name: \"*bordinha*\",\n        object: token,\n    });\n    if (effects.length) {\n        console.log(\"removing effect\")\n        Sequencer.EffectManager.endEffects({ name: \"*bordinha*\", object: token });\n    }\n    else {\n        console.log(\"adding effect\", size, cor)\n        new Sequence()\n            .effect()\n            .file(`/modules/gurps-instant-defaults/packs/borders/${cor}.webm`)\n            .attachTo(token)\n            .scale(Number(size))\n            .atLocation(token)\n            .persist()\n            .name(\"bordinha\")\n            .elevation(0)\n            .play();\n    }\n}","ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{"world":{"sizes":"0.39","poder":{"foo":"$350","bar":"$540","zip":"$400"}},"gurps-instant-defaults":{"sizes":""},"core":{"sourceId":"Macro.S5hjkNBOiqdm8lmb"},"combat-utility-belt":{"macroTrigger":""}},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1665459890841,"modifiedTime":1669696547625,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"PQ2Y3q1o8l3H4ZUP"}
{"name":"Healing Tool","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/magic/holy/chalice-glowing-gold-water.webp","scope":"global","command":"const targets = Array.from(game.user.targets);\n\n//MINOR HEALING\n\n\nfunction minorHealing(energy) {\n  if ((energy > 3)) {\n    ui.notifications.error(\"The value need to be equal or lower than 3\");\n    dialogEditor.render(true);\n        \n \n//  energy = Object.keys(energy).length === 0 {\n//       ui.notifications.error(\"Choose a value between 1-3\");\n      \n      \n\n    } else {\n      \n      \n      GURPS.executeOTF(`/r [/hp +${energy}  @target]`)\n      GURPS.executeOTF(`/r [/fp -${energy}]`)\n    }\n  }\n\n\n  //MAJOR HEALING\n\n\nfunction majorHealing(energy) {\n  if ((canvas.tokens.controlled[0] === 0 & Array.from(game.user.targets)[0] === 0)) {\n    ui.notifications.error(\"You need some energy to cast this spell!\");\n    dialogEditor.render(true);\n\n  } else {\n    let realHealing = energy * 2\n    targets.forEach((target) => {\n    GURPS.executeOTF(`/r [/hp +${realHealing}  @target]`)\n    GURPS.executeOTF(`/r [/fp -${energy}]`);\n    }\n    )};\n  \n\n}\n\n//GREATER HEALING\n\nfunction greaterHealing(energy) {\n\n  GURPS.executeOTF(`/r [/hp reset  @target]`)\n  GURPS.executeOTF(`/r [/fp -20]`)\n}\n\nlet dialogContent =\n` \n\n    <form>\n    <div class=\"form-group\">\n      <label>Fatigue Points:</label>\n      <input id=\"energy\" name=\"energy\" type=\"number\" value=\"1\" min=\"1\" max=\"20\">\n      </div>    \n`\n  ;\n\n//let applyChanges = false\nlet dialogButtons = {\n \n\n  minorHealing: {\n\n    label: `Minor Healing`,\n    callback: async (html) => minorHealing(html.find('#energy').val())\n  },\n  majorHealing: {\n\n    label: `Major Healing`,\n    callback: async (html) => majorHealing(html.find('#energy').val())\n  },\n  greaterHealing: {\n\n    label: `Greater Healing`,\n    callback: async (html) => greaterHealing(html.find('#energy').val())\n  }\n}\n\nlet dialogEditor = new Dialog({\n  title: `Instant Healings`,\n  content: dialogContent,\n  buttons: dialogButtons,\n  default: \"yes\",\n})\n\ndialogEditor.render(true);","flags":{"core":{"sourceId":"Macro.npfhk5aF2sMZi0Cg"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547622,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"Q6XVPWj1b7dcqMFa"}
{"name":"New Macro","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"GURPS.recurselist(GURPS.LastActor.system.equipment.carried, (e, key, d) => {\n\nconst formatter = new Intl.NumberFormat('de-DE', {\n  style: 'currency',\n  currency: 'EUR',\n})\n  if (e.name.includes(\"eddies\"))\n//total = e.cost * e.count\n\n\n\nChatMessage.create({\n        speaker: {alias: \"Banco de Night City\"},\n\n        content: `<p style=\"background-color: black;\n                            color: green;\n                            border-radius: 0px 18px 0px 18px;\n                            border-color: green;\n                            height: 100px;\n                            font-weight: 900;\n                            padding: 40px;\n                            border-width: 3px;\"> You have: \n\n                            <span style=\"\n                            font-weight: 1900;\n                            color: white;\">\n                            ${formatter.format(`${e.count}`)}$\n                </span>\n                  </p>`})\n})","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1670010823190,"modifiedTime":1670034054389,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"S6p8Pvs1rUktIN1L"}
{"name":"#[CF_tempEntity]","type":"chat","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","scope":"global","command":"","flags":{"cf":{"id":"temp_pn0x3le0bx","name":"Macros","color":"#000000","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["cWucJTpypbC96DpL","b5jGz6Mg8DgHdPsu","gPfNLGhPZSb8ZK3I","iJg3vYslNj958o30","TVFAD9kLLT3nl2QG","fpm1y2KEbiCkJRSw","lPjmmtmgyqjK9vTR","yQqXRhLgMqGR8js4","g7bncwhoimLeaRQs","FGUPlNy6RMT7OBvx"],"children":[],"folderPath":[],"version":"2.4.7"},"core":{"sourceId":"Compendium.myUselessMacros.GURPS4E-Macro.3Xlz0rgOgRi2lJX7"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547621,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"SnpQkxZAKRawdYLr"}
{"name":"Journal Menu","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/tools/scribal/ink-quill-pink.webp","scope":"global","command":"const managerType = 'Journal Menu';\n\n(()=>{\n  const journals = [\n    \n    \"Vision\",\n    \"Escudo\"   \n\n  ];\n\n    let buttons = {}, dialog, content = `<div sytle=\"width:100%;text-align:center;><h2>Choose Journal</h2></div>`;\n  \n  \n  journals.forEach((str)=> {\n    let journal = game.journal.getName(str);\n    if(!journal) return;\n\n    buttons[str] = {\n      label : `\n        <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        \n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>`,\n      callback : () => {\n        game.journal.getName(str).sheet.render(true);\n       dialog.render(true);\n      }\n    }\n  });\n  dialog = new Dialog({title : `${managerType}`,content, buttons}).render(true);\n})();","flags":{"core":{"sourceId":"Macro.2mBXApLhSAET8wtI"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547623,"modifiedTime":1669696547623,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"UgkpRFYETNuhxfHP"}
{"name":"Fatigue","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/equipment/feet/boots-leather-laced-brown.webp","scope":"global","command":"/*\nOnly works in GURPS Game Aid.(how are you feeling now DnD'ers?)\nSelect your party e click to run the macro. The FP adjustmentes will be made based\non your actual encumbrance. When use it to calculate FP on Hiking, stop the hiking\nand recalculate when the first character is 1/3 FP.\nI hope you enjoy it!\n*/\nif (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select the tokens\");\n\n\n\nlet actors = canvas.tokens.controlled.map((i) => i.actor);\nif (!actors.length)\n  actors = game.users\n    .filter((i) => i.active && !!i.character)\n    .map((i) => i.character);\nfor (const actor of actors) {\n  const encumbrance = actor.system.encumbrance;\n  const FP = actor.system.FP;\n  const current = Object.values(encumbrance).find((i) => i.current);\n  const key = current.key;\n  const value = actor.system.FP.value;\n  if (key === \"enc0\") await actor.update({ \"data.FP.value\": value - 1 });\n  else if (key === \"enc1\") await actor.update({ \"data.FP.value\": value - 2 });\n  else if (key === \"enc2\") await actor.update({ \"data.FP.value\": value - 3 });\n  else if (key === \"enc3\") await actor.update({ \"data.FP.value\": value - 4 });\n  else if (key === \"enc4\") await actor.update({ \"data.FP.value\": value - 5 });\n  ChatMessage.create({content:  `<p>${actor.name} have <b>${FP.value} FP</b></p>`});\n}","flags":{"core":{"sourceId":"Macro.E2P570JwpoQEoRPl"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547624,"modifiedTime":1669696547624,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"Y2fZDdbuWuIzXswL"}
{"name":"Contacts","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/environment/people/commoner.webp","command":"const myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/contact.html\");\n\nnew Dialog({\n  title: \"GURPS Instant Contacts\",\n  content: myContent,\n  buttons: {}\n}).render(true);","ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.pFxphiDbyADKXuKC"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1668276798922,"modifiedTime":1669696547620,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"YlSzCYdeIdNjZjLR"}
{"name":"Random picker","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"//select a bunch of tokens and execute macro.\n\n\nconst tokens = canvas.tokens.controlled;\nconst rand = Math.floor(Math.random() * tokens.length);\nconst name = tokens[rand].document.name;\nconst image = tokens[rand].document.texture.src;\nChatMessage.create({\n content: \"<div style='font-size: 1.8em; margin: 1em 0; text-align: center;'><img src='\" + image + \"' style='max-width:6em;border:none;'><br>\" + name + \"</div>\",\n whisper: [game.user.id]\n});","ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{"core":{"sourceId":"Macro.A5N2tK8oKLorO4iM"},"combat-utility-belt":{"macroTrigger":""}},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1666902698419,"modifiedTime":1669696547623,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"YxSbQmp4OCLOkuxH"}
{"name":"Sight Adjustment","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/skills/targeting/crosshair-arrowhead-blue.webp","scope":"global","command":"/*\nSelect all tokens to change the size of sight.\nClick on Macro with:\n\nCtrl  = Increase Sight +1\nAlt = decrease Sight -1\n\nOnly Click in the macro you will change your sight by 0\n\n*/\n\n\nconst updates = canvas.tokens.controlled.map(i => {\n  const dimSight = Number(i.document.sight.range);\n  const change = event.ctrlKey ? dimSight + 0.8 : event.altKey ? dimSight -1 : 0;\n  return {_id: i.id, dimSight: Math.max(change, 0)};\n});\nawait canvas.scene.updateEmbeddedDocuments(\"Token\", updates);","flags":{"core":{"sourceId":"Macro.x4SKjhUyWSJeecrz"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1664843591301,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"aV4XLgmciSv50a1m"}
{"name":"Falling Calculator","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/skills/movement/arrow-down-pink.webp","scope":"global","command":"if (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select the falling token\");\n\n\n\nconst myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/falling.html\");\n\nnew Dialog({\n  title: \"GURPS Instant Falling Damage\",\n  content: myContent,\n  buttons: {}\n}).render(true);","flags":{"core":{"sourceId":"Macro.edXnzxry3c8iIM2p"},"cf":{"id":"temp_etvk8gr4cam"},"combat-utility-belt":{"macroTrigger":""}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547621,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"ausDr2K1wDsAvlLP"}
{"name":"Resize","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/magic/movement/chevrons-down-yellow.webp","command":"let tokens = canvas.tokens.controlled\ntokens.forEach(t => {\n    if (token.data.width<1)\n        t.document.update({\"width\": 1, \"height\": 1});\n    else if (token.data.width>=1)\n        t.document.update({\"width\": .5, \"height\": .5});\n})","ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{"core":{"sourceId":"Macro.78ZavNQFxJKwjqLU"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1665527251394,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"bsM8cFewrYOxNaj2"}
{"name":"#[CF_tempEntity]","type":"chat","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","scope":"global","command":"","flags":{"cf":{"id":"temp_etvk8gr4cam","name":"Calculator","color":"#000000","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["XZvgTKh2xPf98cLO","czLsLxFhGA2mgRHy","KF8VDAY7IXYeOFSu","24HQWV0CIGZXECT1","Rut3d9IplQu7Mstj","m4bgVALDKeqxZnNS","IoLnQV0YIxa0d8pb"],"children":[],"folderPath":[],"version":"2.5.3"},"core":{"sourceId":"Compendium.myUselessMacros.GURPS4E-Macro.ZTZZ2SJ2HKynNflz"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547622,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"ddDYdO2aDMvHFOv5"}
{"name":"Body Parts","type":"script","author":"mW8b5k19Zu6i2R2v","img":"modules/gurps-instant-defaults/img/icons/bodyParts/face.png","scope":"global","command":"const managerType = \"Body Parts\";\n\n(() => {\n  const tables = [\n    \"Abdomen\",\n    \"Arm\",\n    \"Chest\",\n    \"Face\",\n    \"Foot\",\n    \"Hand\",\n    \"Leg\",\n    \"Neck\"\n     ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  tables.forEach((str) => {\n    let table = game.tables.getName(str);\n    if (!table) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#bp .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #bp header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#bp .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #bp .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${table.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.tables.getName(str).draw();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"bp\" }\n  ).render(true);\n})();","flags":{"core":{"sourceId":"Macro.bLIEcmBOaxoJl7yO"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547623,"modifiedTime":1669696547623,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"fDRqOMS9bjXzklNo"}
{"name":"Caesar's Cipher","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/sundries/gaming/dice-runed-brown.webp","scope":"global","command":"const myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/cripto.html\");\n\nnew Dialog({\n  title: \"GURPS\",\n  content: myContent,\n  buttons: {}\n}, { id: 'cypher'}).render(true);","flags":{"core":{"sourceId":"Macro.OUICocE2cU8t69eO"},"cf":{"id":"temp_etvk8gr4cam"},"combat-utility-belt":{"macroTrigger":""}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547623,"modifiedTime":1669696547623,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"fWZpIpraFbgH8RWa"}
{"name":"Sight Toggle","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","scope":"global","command":"if (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"Select your token token\");\n\nawait token.document.update({sightAngle : token.document.sight.angle === 360 ? 275 : 360});","flags":{"core":{"sourceId":"Macro.kRKbNVaRiRhyjZOD"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1664843588971,"modifiedTime":1669696547625,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"iFyJBTGtcraM5HgT"}
{"name":"New Macro","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"const myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/teste.html\");\n\nnew Dialog({\n  title: \"GURPS Instant Contacts\",\n  content: myContent,\n  buttons: {}\n}).render(true);","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.290","createdTime":1670001189528,"modifiedTime":1670001230148,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"kvUZskEx5GoNkv0d"}
{"name":"First Aid Calculator","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/magic/life/heart-glowing-red.webp","scope":"global","command":"const myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/firstAid.html\");\n\nnew Dialog({\n  title: \"GURPS\",\n  content: myContent,\n  buttons: {}\n}).render(true);","flags":{"core":{"sourceId":"Macro.eiBOlcjpYF6WwZ5M"},"cf":{"id":"temp_etvk8gr4cam"},"combat-utility-belt":{"macroTrigger":""}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547621,"modifiedTime":1669696547621,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"mLxvvKASA0LpAK5a"}
{"name":"achar coisas","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"//Verifica o bônus e a dificuldade\nlet applyChanges = false;\nnew Dialog({\n  title: `Teste de Força`,\n  content: `\n    <form>\n    \n    <div class=\"form-group\">\n        <label>Dificuldade:</label>\n        <select id=\"dificuldade\" name=\"dificuldade\">\n          <option value=\"4\">Fácil (4)</option>\n          <option value=\"5\">Normal (5)</option>\n          <option value=\"6\">Difícil (6)</option>\n        </select>\n      </div>\n      \n      <div class=\"form-group\">\n        <label>Bônus:</label>\n        <input type=\"number\" id=\"bonus\" name=\"bonus\" value=0>\n      </div>\n      \n    </form>\n    `,\n  buttons: {\n    yes: {\n      icon: \"<i class='fas fa-check'></i>\",\n      label: `Aplicar`,\n      callback: () => applyChanges = true\n    },\n    no: {\n      icon: \"<i class='fas fa-times'></i>\",\n      label: `Cancelar`\n    },\n  },\n  default: \"yes\",\n  close: html => {\n    if (applyChanges) {\n      for ( let token of canvas.tokens.controlled ) {\n      \n     \n      let dificuldade = parseInt(html.find('[name=\"dificuldade\"]')[0].value || \"none\");\n      let bonus = parseInt(html.find('[name=\"bonus\"]')[0].value || \"none\");\n      let forca = token.actor.system.attributes.atr.atr1_for.value;\n      \nnew Roll(`${1 + forca + bonus}d6kh1cs>=${dificuldade}`).toMessage({flavor: \"TESTE DE FORÇA\"})\n\nif (Roll>= dificuldade) {ChatMessage.create({content: `SUCESSO`}) }\n\nelse {ChatMessage.create({content: `FRACASSO`})}\n\n      }\n    }\n  }\n}).render(true);","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1670232883241,"modifiedTime":1670259590111,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"oK2i2eeLdW71adwZ"}
{"name":"#[CF_tempEntity]","type":"chat","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","scope":"global","command":"","flags":{"cf":{"id":"temp_58ibxbr8cng","name":"Tables","color":"#000000","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["z1H3yBmWLs3TFTbt","T4lat5EDOgrcJ3vP"],"children":[]},"core":{"sourceId":"Compendium.myUselessMacros.GURPS4E-Macro.QnA9iTItTiNFCEi9"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547622,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"pUk8bV1LcojyXZ3R"}
{"name":"Draw Walls","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/environment/settlement/city-wall.webp","command":"let drawings = canvas.drawings.controlled;\n\nif (!drawings.length) return ui.notifications.warn(\"No Drawings\");\ndrawings = drawings.map(drawing => {\n    console.log(drawing.document);\n    switch (drawing.document.shape.type) {\n        case \"f\":\n        case \"p\": {\n            let { id, rotation, x, y  } = drawing.document;\n            let { width, height , points} = drawing.document.shape;\n            points = points.reduce((a,x,i)=> {\n              if((i+2)%2) a[Math.floor(i/2)].push(x);\n              else a.push([x]);\n              return a;\n            }, []);\n            return { id, valid: true, points, rotation, x, y, width, height };\n        }\n        case \"r\": {\n            let { id, rotation, x, y  } = drawing.document;\n            let { width, height } = drawing.document.shape;\n            const points = [\n                [0, 0],\n                [width, 0],\n                [width, height],\n                [0, height],\n                [0, 0],\n            ];\n            return { id, valid: true, points, rotation, x, y, width, height };\n        }\n        case \"e\": {\n            let { id, rotation, x, y  } = drawing.document;\n            let { width, height} = drawing.document.shape;\n            let size = (height>width?height:width)/canvas.grid.size*60;\n            let segmentCount = Math.max(Math.ceil(Math.sqrt(size/2)), 4);\n            let step = 2*Math.PI/segmentCount;  // see note 1\n            let h = drawing.center.x-x;\n            let k = drawing.center.y-y;\n            let r = width/2;\n            let t = height/width;\n            let points = [];\n            let segment = [];\n            let start = [];\n            for(let theta=0;  theta < 2*Math.PI;  theta+=step) { \n              let x = h +     r*Math.cos(theta);\n              let y = k - t * r*Math.sin(theta); \n              \n               if (theta==0) \n                start = [Math.round(x), Math.round(y)];\n              \n              points.push([Math.round(x),Math.round(y)]);\n              \n              if (segment.length > 2)\n               points.push(segment.map(p=>p))\n            }\n            points.push(start)\n            return { id, valid: true, points, rotation, x, y, width, height };\n          }\n        default:\n            return { id: drawing.data._id, valid: false }; \n    }\n}).filter(drawing => {\n    if (!drawing.valid) {\n        ui.notifications.warn(`Drawing \"${drawing.id}\" is not a valid drawing type`);\n        return false;\n    }\n    return true;\n});\n\n//console.log(\"drawings\", drawings)\n    const newWalls = drawings.flatMap((drawing) => {\n        const { x, y, width, height } = drawing;\n        const xCenterOffset = width/2;\n        const yCenterOffset = height/2;\n        \n        const θ = Math.toRadians(drawing.rotation);\n        const cosθ = Math.cos(θ);\n        const sinθ = Math.sin(θ);\n        \n        const points = drawing.points.map((point) => {\n            const offsetX = point[0] - xCenterOffset;\n            const offsetY = point[1] - yCenterOffset;\n            const rotatedX = (offsetX * cosθ - offsetY * sinθ);\n            const rotatedY = (offsetY * cosθ + offsetX * sinθ);\n            //console.log( x, y, width, height, offsetX, offsetY, rotatedX, rotatedY, xCenterOffset, yCenterOffset);\n            return [rotatedX + x + xCenterOffset, rotatedY + y + yCenterOffset];\n            \n        });\n        //console.log(points)\n        \n        return points\n            .slice(0, points.length - 1)\n            .map((point, i) => ({ c: point.concat(points[i + 1]) }));\n    });\n    //console.log(drawings, newWalls);\n    canvas.scene.createEmbeddedDocuments(\"Wall\", newWalls);\n    canvas.walls.activate();","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1670095991221,"modifiedTime":1670257956823,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"q8DU3gyMbvtRBgxB"}
{"name":"Compendium Menu","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/sundries/books/book-embossed-blue.webp","scope":"global","command":"const managerType = 'Compendium Menu';\n\n(()=>{\n  const journals = [\n    \n    \"gurps-instant-defaults.GURPS4E-Basic-Set\" , \n    \"GURPS-Modifier-Tables.tables\",\n    \"gurps-instant-defaults.GURPS4E-Dungeon-Fantasy-RPG\",\n    \"GURPS RollTables\"\n   \n\n  ];\n\n  let path = 'icons/sundries/books/',\nfiles = [\n    'book-backed-silver-gold.webp', \n    'book-worn-brown-grey.webp',\n     'book-worn-blue.webp',\n      'book-symbol-canterbury-cross.webp',\n       'book-symbol-triangle-silver-purple.webp',\n        'book-tooled-silver-blue.webp',\n         'book-symbol-fire-gold-orange.webp',\n          'book-stack.webp',\n           'book-embossed-spiral-purple-white.webp',\n            'book-symbol-leaf-green.webp']\ni = Math.floor(Math.random()*files.length);\nlet imagem = (path+files[i]);\nconsole.log(imagem)\n\n    let buttons = {}, dialog, content = `<div sytle=\"width:100%;text-align:center;><h2>Choose Journal</h2></div>`;\n  \n  \n  journals.forEach((str)=> {\n    let journal = game.packs.get(str);\n    if(!journal) return;\n    const name = journal.metadata.label;\n\n    buttons[str] = {\n      label : `\n        <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        \n        <img src=\"${imagem}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${name}</label></div>\n        </div>`,\n      callback : () => {\n        game.packs.get(str).render(true);\n       dialog.render(true);\n      }\n    }\n  });\n  dialog = new Dialog({title : `${managerType}`,content, buttons}).render(true);\n})();","flags":{"core":{"sourceId":"Macro.qsWPXt5DBqz5Yis1"},"cf":{"id":"temp_pn0x3le0bx"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547624,"modifiedTime":1669696547624,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"wyNigTPiNMYjTunO"}
{"name":"Bet on it","type":"script","author":"mW8b5k19Zu6i2R2v","img":"icons/sundries/gaming/playing-cards.webp","scope":"global","command":"const myContent = await renderTemplate(\"modules/gurps-instant-defaults/templates/gambling2.html\");\n\nnew Dialog({\n  title: \"GURPS\",\n  content: myContent,\n  buttons: {}\n}, { id: 'gambling'}).render(true);","flags":{"core":{"sourceId":"Macro.Uudkyh1b9ZGrjvvH"},"cf":{"id":"temp_etvk8gr4cam"}},"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"_stats":{"systemId":"gurps","systemVersion":"0.15.11","coreVersion":"10.288","createdTime":1669696547622,"modifiedTime":1669696547622,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"xd9cFMkOzEQTdXE1"}
{"name":"New Macro","type":"chat","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.290","createdTime":1670001778378,"modifiedTime":1670001778378,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"z12CMQMGyQbq4eJa"}
{"name":"interessante","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/svg/dice-target.svg","command":"const image1 = `https://i.imgur.com/image1.png`;\nconst image2 = `https://i.imgur.com/image2.png`;\nconst image3 = `https://i.imgur.com/image3.png`;\nconst image4 = `https://i.imgur.com/image4.png`;\nconst image5 = `https://i.imgur.com/image5.png`;\n\nlet d = new Dialog({\ntitle: \"Tokens\",\nbuttons: {\none: {\n label: `<img src= \"${image1}\">`,\n callback: () => {token.document.update({ \"texture.src\": image1 })}\n},\ntwo: {\n  label: `<img src= \"${image2}\">`,\n  callback: () => {token.document.update({ \"texture.src\": image2 })}\n },\n three: {\n  label: `<img src= \"${image3}\"`,\n  callback: () => {token.document.update({ \"texture.src\": image3 })}\n },\nfour: {\n  label: `<img src= \"${image4}\"`,\n  callback: () => {token.document.update({ \"texture.src\": image4 })}\n },\nfive: {\n  label: `<img src= \"${image5}\"`,\n  callback: () => {token.document.update({ \"texture.src\": image5 })}\n }\n},\ndefault: \"one\",\nrender: html => console.log(\"Register interactivity in the rendered dialog\"),\nclose: html => console.log(\"This always is logged no matter which option is chosen\")\n});\nd.render(true);","folder":null,"sort":0,"ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{"core":{"sourceId":"Compendium.myuselessmacros.GURPS4E-Macro.yf3uPa1nz2nC7MDE"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1670033783251,"modifiedTime":1670264336287,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"_id":"5oF1nIMcX2Izf0os"}
{"name":"Random picker","type":"script","scope":"global","author":"mW8b5k19Zu6i2R2v","img":"icons/skills/targeting/crosshair-pointed-orange.webp","command":"//select a bunch of tokens and execute macro.\n\n\nconst tokens = canvas.tokens.controlled;\nconst rand = Math.floor(Math.random() * tokens.length);\nconst name = tokens[rand].document.name;\nconst image = tokens[rand].document.texture.src;\nChatMessage.create({\n content: \"<div style='font-size: 1.8em; margin: 1em 0; text-align: center;'><img src='\" + image + \"' style='max-width:6em;border:none;'><br>\" + name + \"</div>\",\n whisper: [game.user.id]\n});","ownership":{"default":0,"mW8b5k19Zu6i2R2v":3},"flags":{"core":{"sourceId":"Macro.A5N2tK8oKLorO4iM"},"combat-utility-belt":{"macroTrigger":""}},"_stats":{"systemId":"gurps","systemVersion":"0.15.12","coreVersion":"10.291","createdTime":1666902698419,"modifiedTime":1670264383991,"lastModifiedBy":"mW8b5k19Zu6i2R2v"},"folder":"qngFmTxsfoMaHPES","sort":0,"_id":"YxSbQmp4OCLOkuxH"}
